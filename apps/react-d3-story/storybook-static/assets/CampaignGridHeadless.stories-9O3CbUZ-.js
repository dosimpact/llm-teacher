import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r as d,R as _}from"./index-B7o9TaAI.js";import"./index-BM9YtLjs.js";const $=({data:e,defaultPageSize:s=10,initialGroupState:u,onBudgetChange:l,onStatusChange:h,onSelectionChange:p})=>{const[x,i]=d.useState(u||e.reduce((a,n)=>(a[n.id]=!0,a),{})),[m,P]=d.useState(null),[o,w]=d.useState({currentPage:1,pageSize:s,totalItems:0});d.useEffect(()=>{var n,y;const a=m?e.find(g=>g.id===m)||((y=(n=e.find(g=>{var S;return(S=g.subCampaigns)==null?void 0:S.some(E=>E.id===m)}))==null?void 0:n.subCampaigns)==null?void 0:y.find(g=>g.id===m)):null;if(a){const g=!e.some(S=>S.id===a.id);p==null||p({...a,isGroup:!g})}else p==null||p(null)},[m,e,p]);const M=d.useCallback(a=>{i(n=>({...n,[a]:!n[a]}))},[]),j=d.useCallback(()=>e.reduce((a,n)=>(a.push(n),x[n.id]&&n.subCampaigns&&a.push(...n.subCampaigns.map(y=>({...y,isGroup:!1}))),a),[]),[e,x]),b=d.useMemo(()=>j(),[j]),C=d.useMemo(()=>b.length,[b]),R=d.useMemo(()=>Math.ceil(C/o.pageSize),[C,o.pageSize]),c=d.useCallback(a=>{w(n=>({...n,currentPage:Math.max(1,Math.min(a,R))}))},[R]),v=d.useCallback(a=>{w(n=>({...n,pageSize:a,currentPage:1}))},[]),B=d.useMemo(()=>{const{currentPage:a,pageSize:n}=o,y=(a-1)*n,g=y+n;return b.slice(y,g)},[b,o]),H=d.useCallback((a,n)=>{l==null||l(a,n)},[l]),q=d.useCallback((a,n)=>{h==null||h(a,n)},[h]);return{currentPageData:B,pagination:{currentPage:o.currentPage,totalPages:R,pageSize:o.pageSize,totalItems:C,setCurrentPage:c,setPageSize:v},groupState:x,toggleGroup:M,updateBudget:H,updateStatus:q,selectedCampaignId:m,setSelectedCampaignId:P}},A=[{field:"checkbox",headerName:"",width:50,type:"checkbox"},{field:"name",headerName:"캠페인명",width:200},{field:"status",headerName:"상태",width:100},{field:"budget",headerName:"예산",width:120,type:"currency"},{field:"spent",headerName:"지출",width:120,type:"currency"},{field:"impressions",headerName:"노출수",width:120,type:"number"},{field:"clicks",headerName:"클릭수",width:120,type:"number"},{field:"conversions",headerName:"전환수",width:120,type:"number"},{field:"ctr",headerName:"CTR",width:100,type:"percentage"},{field:"cpc",headerName:"CPC",width:100,type:"currency"},{field:"startDate",headerName:"시작일",width:120,type:"date"},{field:"endDate",headerName:"종료일",width:120,type:"date"}],z=({data:e,defaultPageSize:s,initialGroupState:u,onBudgetChange:l,onStatusChange:h,onSelectionChange:p,renderRow:x,renderHeader:i,renderPagination:m})=>{const{currentPageData:P,pagination:o,groupState:w,toggleGroup:M,updateBudget:j,updateStatus:b,selectedCampaignId:C,setSelectedCampaignId:R}=$({data:e,defaultPageSize:s,initialGroupState:u,onBudgetChange:l,onStatusChange:h,onSelectionChange:p});return t.jsxs("div",{children:[i({columns:A}),P.map(c=>t.jsx(_.Fragment,{children:x({row:c,isExpanded:w[c.id]||!1,isSelected:c.id===C,onToggleGroup:()=>M(c.id),onBudgetChange:v=>j(c.id,v),onStatusChange:v=>b(c.id,v),onSelect:()=>R(C===c.id?null:c.id)})},c.id)),m&&m({currentPage:o.currentPage,totalPages:o.totalPages,pageSize:o.pageSize,totalItems:o.totalItems,onPageChange:o.setCurrentPage})]})};z.__docgenInfo={description:"",methods:[],displayName:"CampaignGridHeadless",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"CampaignGroupData"}],raw:"CampaignGroupData[]"},description:""},defaultPageSize:{required:!1,tsType:{name:"number"},description:""},initialGroupState:{required:!1,tsType:{name:"GroupState"},description:""},onBudgetChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(campaignId: string, newBudget: number) => void",signature:{arguments:[{type:{name:"string"},name:"campaignId"},{type:{name:"number"},name:"newBudget"}],return:{name:"void"}}},description:""},onStatusChange:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  campaignId: string,
  newStatus: CampaignData["status"]
) => void`,signature:{arguments:[{type:{name:"string"},name:"campaignId"},{type:{name:'CampaignData["status"]',raw:'CampaignData["status"]'},name:"newStatus"}],return:{name:"void"}}},description:""},onSelectionChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(selectedCampaign: CampaignGroupData | null) => void",signature:{arguments:[{type:{name:"union",raw:"CampaignGroupData | null",elements:[{name:"CampaignGroupData"},{name:"null"}]},name:"selectedCampaign"}],return:{name:"void"}}},description:""},renderRow:{required:!0,tsType:{name:"signature",type:"function",raw:"(props: CampaignRenderRowProps) => React.ReactNode",signature:{arguments:[{type:{name:"CampaignRenderRowProps"},name:"props"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},renderHeader:{required:!0,tsType:{name:"signature",type:"function",raw:"(props: CampaignRenderHeaderProps) => React.ReactNode",signature:{arguments:[{type:{name:"CampaignRenderHeaderProps"},name:"props"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},renderPagination:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: CampaignRenderPaginationProps) => React.ReactNode",signature:{arguments:[{type:{name:"CampaignRenderPaginationProps"},name:"props"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""}}};const J={title:"AG Grid Advanced/CampaignGridHeadless",component:z,parameters:{layout:"centered"},decorators:[e=>t.jsx("div",{style:{margin:"1em",minWidth:"1200px"},children:t.jsx(e,{})})]},N=(e,s)=>({id:e,name:e,isGroup:!0,status:"active",budget:Math.floor(Math.random()*1e6),spent:Math.floor(Math.random()*5e5),impressions:Math.floor(Math.random()*1e5),clicks:Math.floor(Math.random()*1e4),conversions:Math.floor(Math.random()*1e3),ctr:Math.random()*10,cpc:Math.random()*100,startDate:"2024-01-01",endDate:"2024-12-31",subCampaigns:Array.from({length:s},(u,l)=>({id:`${e}-sub-${l+1}`,name:`${e} 하위 캠페인 ${l+1}`,isGroup:!1,status:"active",budget:Math.floor(Math.random()*1e5),spent:Math.floor(Math.random()*5e4),impressions:Math.floor(Math.random()*1e4),clicks:Math.floor(Math.random()*1e3),conversions:Math.floor(Math.random()*100),ctr:Math.random()*10,cpc:Math.random()*100,startDate:"2024-01-01",endDate:"2024-12-31"}))}),D=[N("검색 광고 캠페인",3),N("디스플레이 광고 캠페인",3),N("쇼핑 광고 캠페인",3)],r={header:{display:"grid",gridTemplateColumns:"repeat(11, 1fr)",padding:"12px 16px",backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0",position:"sticky",top:0,fontWeight:600,color:"#1e293b"},headerCell:{display:"flex",alignItems:"center",justifyContent:"flex-start"},row:{display:"grid",gridTemplateColumns:"repeat(11, 1fr)",padding:"12px 16px",borderBottom:"1px solid #e2e8f0",transition:"all 0.2s ease","&:hover":{backgroundColor:"#f1f5f9"}},cell:{display:"flex",alignItems:"center",justifyContent:"flex-start"},groupRow:{backgroundColor:"#f8fafc",fontWeight:600},childRow:{backgroundColor:"white",paddingLeft:"32px"},toggleIcon:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #cbd5e1",borderRadius:"4px",marginRight:"8px",cursor:"pointer",transition:"all 0.2s ease"},pagination:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"16px",borderTop:"1px solid #e2e8f0"},pageButton:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"4px",backgroundColor:"white",cursor:"pointer","&:hover":{backgroundColor:"#f1f5f9"},"&:disabled":{backgroundColor:"#f8fafc",cursor:"not-allowed"}},selectedRow:{backgroundColor:"#e0f2fe","&:hover":{backgroundColor:"#bae6fd"}},checkbox:{width:"20px",height:"20px",cursor:"pointer"}},F=({columns:e})=>t.jsx("div",{style:{...r.header,gridTemplateColumns:"50px repeat(10, 1fr)"},children:e.map(s=>t.jsx("div",{style:r.headerCell,children:s.headerName},s.field))}),f=(e,s)=>{switch(s){case"currency":return new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW"}).format(Number(e));case"number":return new Intl.NumberFormat("ko-KR").format(Number(e));case"percentage":return`${Number(e).toFixed(2)}%`;case"date":return new Date(e).toLocaleDateString("ko-KR");default:return e}},K=({row:e,isExpanded:s,isSelected:u,onToggleGroup:l,onBudgetChange:h,onStatusChange:p,onSelect:x})=>t.jsxs("div",{style:{...r.row,...e.isGroup?r.groupRow:r.childRow,...u?r.selectedRow:{},gridTemplateColumns:"50px repeat(10, 1fr)"},children:[t.jsx("div",{style:r.cell,children:t.jsx("input",{type:"checkbox",checked:u,onChange:i=>{i.stopPropagation(),x()},style:r.checkbox})}),t.jsxs("div",{style:r.cell,children:[e.isGroup&&t.jsx("div",{style:r.toggleIcon,onClick:i=>{i.stopPropagation(),l()},children:s?"-":"+"}),e.name]}),t.jsx("div",{style:r.cell,children:t.jsxs("select",{value:e.status,onChange:i=>{i.stopPropagation(),p(i.target.value)},style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #e2e8f0"},children:[t.jsx("option",{value:"active",children:"활성"}),t.jsx("option",{value:"paused",children:"일시중지"}),t.jsx("option",{value:"ended",children:"종료"})]})}),t.jsx("div",{style:r.cell,children:t.jsx("input",{type:"number",value:e.budget,onChange:i=>{i.stopPropagation(),h(Number(i.target.value))},onClick:i=>i.stopPropagation(),style:{width:"100px",padding:"4px 8px",borderRadius:"4px",border:"1px solid #e2e8f0"}})}),t.jsx("div",{style:r.cell,children:f(e.spent,"currency")}),t.jsx("div",{style:r.cell,children:f(e.impressions,"number")}),t.jsx("div",{style:r.cell,children:f(e.clicks,"number")}),t.jsx("div",{style:r.cell,children:f(e.conversions,"number")}),t.jsx("div",{style:r.cell,children:f(e.ctr,"percentage")}),t.jsx("div",{style:r.cell,children:f(e.cpc,"currency")}),t.jsx("div",{style:r.cell,children:f(e.startDate,"date")}),t.jsx("div",{style:r.cell,children:f(e.endDate,"date")})]}),W=({currentPage:e,totalPages:s,onPageChange:u})=>t.jsxs("div",{style:r.pagination,children:[t.jsx("button",{style:r.pageButton,onClick:()=>u(e-1),disabled:e===1,children:"이전"}),t.jsxs("span",{children:[e," / ",s]}),t.jsx("button",{style:r.pageButton,onClick:()=>u(e+1),disabled:e===s,children:"다음"})]}),k={args:{data:D,defaultPageSize:10,renderHeader:F,renderRow:K,renderPagination:W,onSelectionChange:e=>{console.log("Selected campaign:",e)},onBudgetChange:(e,s)=>console.log("Budget changed:",{campaignId:e,newBudget:s}),onStatusChange:(e,s)=>console.log("Status changed:",{campaignId:e,newStatus:s}),initialGroupState:D.reduce((e,s)=>(e[s.id]=!0,e),{})}};var I,G,T;k.parameters={...k.parameters,docs:{...(I=k.parameters)==null?void 0:I.docs,source:{originalSource:`{
  args: {
    data: sampleData,
    defaultPageSize: 10,
    renderHeader: CustomHeader,
    renderRow: CustomRow,
    renderPagination: CustomPagination,
    onSelectionChange: campaign => {
      console.log("Selected campaign:", campaign);
    },
    onBudgetChange: (campaignId, newBudget) => console.log("Budget changed:", {
      campaignId,
      newBudget
    }),
    onStatusChange: (campaignId, newStatus) => console.log("Status changed:", {
      campaignId,
      newStatus
    }),
    initialGroupState: sampleData.reduce((acc, item) => {
      acc[item.id] = true;
      return acc;
    }, {} as Record<string, boolean>)
  }
}`,...(T=(G=k.parameters)==null?void 0:G.docs)==null?void 0:T.source}}};const Q=["Default"];export{k as Default,Q as __namedExportsOrder,J as default};

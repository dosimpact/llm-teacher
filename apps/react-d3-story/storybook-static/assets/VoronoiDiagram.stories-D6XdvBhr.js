import{j as Pt}from"./jsx-runtime-D_zvdyIk.js";import{r as et}from"./index-B7o9TaAI.js";import{s as O}from"./transform-BIeV-TGt.js";import{o as $t}from"./ordinal-BIATHBfR.js";import{S as jt}from"./Set3-CKsqm_QX.js";import"./index-BM9YtLjs.js";import"./colors-Cc3OSVma.js";const R=11102230246251565e-32,q=134217729,Dt=(3+8*R)*R;function nt(f,t,e,i,n){let s,l,r,o,c=t[0],d=i[0],a=0,h=0;d>c==d>-c?(s=c,c=t[++a]):(s=d,d=i[++h]);let u=0;if(a<f&&h<e)for(d>c==d>-c?(l=c+s,r=s-(l-c),c=t[++a]):(l=d+s,r=s-(l-d),d=i[++h]),s=l,r!==0&&(n[u++]=r);a<f&&h<e;)d>c==d>-c?(l=s+c,o=l-s,r=s-(l-o)+(c-o),c=t[++a]):(l=s+d,o=l-s,r=s-(l-o)+(d-o),d=i[++h]),s=l,r!==0&&(n[u++]=r);for(;a<f;)l=s+c,o=l-s,r=s-(l-o)+(c-o),c=t[++a],s=l,r!==0&&(n[u++]=r);for(;h<e;)l=s+d,o=l-s,r=s-(l-o)+(d-o),d=i[++h],s=l,r!==0&&(n[u++]=r);return(s!==0||u===0)&&(n[u++]=s),u}function Ct(f,t){let e=t[0];for(let i=1;i<f;i++)e+=t[i];return e}function G(f){return new Float64Array(f)}const Lt=(3+16*R)*R,qt=(2+12*R)*R,Vt=(9+64*R)*R*R,U=G(4),ot=G(8),at=G(12),ht=G(16),V=G(4);function zt(f,t,e,i,n,s,l){let r,o,c,d,a,h,u,m,g,p,_,b,A,k,M,I,$,S;const y=f-n,x=e-n,w=t-s,T=i-s;k=y*T,h=q*y,u=h-(h-y),m=y-u,h=q*T,g=h-(h-T),p=T-g,M=m*p-(k-u*g-m*g-u*p),I=w*x,h=q*w,u=h-(h-w),m=w-u,h=q*x,g=h-(h-x),p=x-g,$=m*p-(I-u*g-m*g-u*p),_=M-$,a=M-_,U[0]=M-(_+a)+(a-$),b=k+_,a=b-k,A=k-(b-a)+(_-a),_=A-I,a=A-_,U[1]=A-(_+a)+(a-I),S=b+_,a=S-b,U[2]=b-(S-a)+(_-a),U[3]=S;let P=Ct(4,U),j=qt*l;if(P>=j||-P>=j||(a=f-y,r=f-(y+a)+(a-n),a=e-x,c=e-(x+a)+(a-n),a=t-w,o=t-(w+a)+(a-s),a=i-T,d=i-(T+a)+(a-s),r===0&&o===0&&c===0&&d===0)||(j=Vt*l+Dt*Math.abs(P),P+=y*d+T*r-(w*c+x*o),P>=j||-P>=j))return P;k=r*T,h=q*r,u=h-(h-r),m=r-u,h=q*T,g=h-(h-T),p=T-g,M=m*p-(k-u*g-m*g-u*p),I=o*x,h=q*o,u=h-(h-o),m=o-u,h=q*x,g=h-(h-x),p=x-g,$=m*p-(I-u*g-m*g-u*p),_=M-$,a=M-_,V[0]=M-(_+a)+(a-$),b=k+_,a=b-k,A=k-(b-a)+(_-a),_=A-I,a=A-_,V[1]=A-(_+a)+(a-I),S=b+_,a=S-b,V[2]=b-(S-a)+(_-a),V[3]=S;const C=nt(4,U,4,V,ot);k=y*d,h=q*y,u=h-(h-y),m=y-u,h=q*d,g=h-(h-d),p=d-g,M=m*p-(k-u*g-m*g-u*p),I=w*c,h=q*w,u=h-(h-w),m=w-u,h=q*c,g=h-(h-c),p=c-g,$=m*p-(I-u*g-m*g-u*p),_=M-$,a=M-_,V[0]=M-(_+a)+(a-$),b=k+_,a=b-k,A=k-(b-a)+(_-a),_=A-I,a=A-_,V[1]=A-(_+a)+(a-I),S=b+_,a=S-b,V[2]=b-(S-a)+(_-a),V[3]=S;const v=nt(C,ot,4,V,at);k=r*d,h=q*r,u=h-(h-r),m=r-u,h=q*d,g=h-(h-d),p=d-g,M=m*p-(k-u*g-m*g-u*p),I=o*c,h=q*o,u=h-(h-o),m=o-u,h=q*c,g=h-(h-c),p=c-g,$=m*p-(I-u*g-m*g-u*p),_=M-$,a=M-_,V[0]=M-(_+a)+(a-$),b=k+_,a=b-k,A=k-(b-a)+(_-a),_=A-I,a=A-_,V[1]=A-(_+a)+(a-I),S=b+_,a=S-b,V[2]=b-(S-a)+(_-a),V[3]=S;const D=nt(v,at,4,V,ht);return ht[D-1]}function X(f,t,e,i,n,s){const l=(t-s)*(e-n),r=(f-n)*(i-s),o=l-r,c=Math.abs(l+r);return Math.abs(o)>=Lt*c?o:-zt(f,t,e,i,n,s,c)}const ct=Math.pow(2,-52),Y=new Uint32Array(512);class tt{static from(t,e=Kt,i=Nt){const n=t.length,s=new Float64Array(n*2);for(let l=0;l<n;l++){const r=t[l];s[2*l]=e(r),s[2*l+1]=i(r)}return new tt(s)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*e-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:i,_hullTri:n,_hullHash:s}=this,l=t.length>>1;let r=1/0,o=1/0,c=-1/0,d=-1/0;for(let y=0;y<l;y++){const x=t[2*y],w=t[2*y+1];x<r&&(r=x),w<o&&(o=w),x>c&&(c=x),w>d&&(d=w),this._ids[y]=y}const a=(r+c)/2,h=(o+d)/2;let u,m,g;for(let y=0,x=1/0;y<l;y++){const w=it(a,h,t[2*y],t[2*y+1]);w<x&&(u=y,x=w)}const p=t[2*u],_=t[2*u+1];for(let y=0,x=1/0;y<l;y++){if(y===u)continue;const w=it(p,_,t[2*y],t[2*y+1]);w<x&&w>0&&(m=y,x=w)}let b=t[2*m],A=t[2*m+1],k=1/0;for(let y=0;y<l;y++){if(y===u||y===m)continue;const x=Ft(p,_,b,A,t[2*y],t[2*y+1]);x<k&&(g=y,k=x)}let M=t[2*g],I=t[2*g+1];if(k===1/0){for(let w=0;w<l;w++)this._dists[w]=t[2*w]-t[0]||t[2*w+1]-t[1];N(this._ids,this._dists,0,l-1);const y=new Uint32Array(l);let x=0;for(let w=0,T=-1/0;w<l;w++){const P=this._ids[w],j=this._dists[P];j>T&&(y[x++]=P,T=j)}this.hull=y.subarray(0,x),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(X(p,_,b,A,M,I)<0){const y=m,x=b,w=A;m=g,b=M,A=I,g=y,M=x,I=w}const $=Ut(p,_,b,A,M,I);this._cx=$.x,this._cy=$.y;for(let y=0;y<l;y++)this._dists[y]=it(t[2*y],t[2*y+1],$.x,$.y);N(this._ids,this._dists,0,l-1),this._hullStart=u;let S=3;i[u]=e[g]=m,i[m]=e[u]=g,i[g]=e[m]=u,n[u]=0,n[m]=1,n[g]=2,s.fill(-1),s[this._hashKey(p,_)]=u,s[this._hashKey(b,A)]=m,s[this._hashKey(M,I)]=g,this.trianglesLen=0,this._addTriangle(u,m,g,-1,-1,-1);for(let y=0,x,w;y<this._ids.length;y++){const T=this._ids[y],P=t[2*T],j=t[2*T+1];if(y>0&&Math.abs(P-x)<=ct&&Math.abs(j-w)<=ct||(x=P,w=j,T===u||T===m||T===g))continue;let C=0;for(let F=0,It=this._hashKey(P,j);F<this._hashSize&&(C=s[(It+F)%this._hashSize],!(C!==-1&&C!==i[C]));F++);C=e[C];let v=C,D;for(;D=i[v],X(P,j,t[2*v],t[2*v+1],t[2*D],t[2*D+1])>=0;)if(v=D,v===C){v=-1;break}if(v===-1)continue;let z=this._addTriangle(v,T,i[v],-1,-1,n[v]);n[T]=this._legalize(z+2),n[v]=z,S++;let L=i[v];for(;D=i[L],X(P,j,t[2*L],t[2*L+1],t[2*D],t[2*D+1])<0;)z=this._addTriangle(L,T,D,n[T],-1,n[L]),n[T]=this._legalize(z+2),i[L]=L,S--,L=D;if(v===C)for(;D=e[v],X(P,j,t[2*D],t[2*D+1],t[2*v],t[2*v+1])<0;)z=this._addTriangle(D,T,v,-1,n[v],n[D]),this._legalize(z+2),n[D]=z,i[v]=v,S--,v=D;this._hullStart=e[T]=v,i[v]=e[L]=T,i[T]=L,s[this._hashKey(P,j)]=T,s[this._hashKey(t[2*v],t[2*v+1])]=v}this.hull=new Uint32Array(S);for(let y=0,x=this._hullStart;y<S;y++)this.hull[y]=x,x=i[x];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(Rt(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:i,coords:n}=this;let s=0,l=0;for(;;){const r=i[t],o=t-t%3;if(l=o+(t+2)%3,r===-1){if(s===0)break;t=Y[--s];continue}const c=r-r%3,d=o+(t+1)%3,a=c+(r+2)%3,h=e[l],u=e[t],m=e[d],g=e[a];if(Et(n[2*h],n[2*h+1],n[2*u],n[2*u+1],n[2*m],n[2*m+1],n[2*g],n[2*g+1])){e[t]=g,e[r]=h;const _=i[a];if(_===-1){let A=this._hullStart;do{if(this._hullTri[A]===a){this._hullTri[A]=t;break}A=this._hullPrev[A]}while(A!==this._hullStart)}this._link(t,_),this._link(r,i[l]),this._link(l,a);const b=c+(r+1)%3;s<Y.length&&(Y[s++]=b)}else{if(s===0)break;t=Y[--s]}}return l}_link(t,e){this._halfedges[t]=e,e!==-1&&(this._halfedges[e]=t)}_addTriangle(t,e,i,n,s,l){const r=this.trianglesLen;return this._triangles[r]=t,this._triangles[r+1]=e,this._triangles[r+2]=i,this._link(r,n),this._link(r+1,s),this._link(r+2,l),this.trianglesLen+=3,r}}function Rt(f,t){const e=f/(Math.abs(f)+Math.abs(t));return(t>0?3-e:1+e)/4}function it(f,t,e,i){const n=f-e,s=t-i;return n*n+s*s}function Et(f,t,e,i,n,s,l,r){const o=f-l,c=t-r,d=e-l,a=i-r,h=n-l,u=s-r,m=o*o+c*c,g=d*d+a*a,p=h*h+u*u;return o*(a*p-g*u)-c*(d*p-g*h)+m*(d*u-a*h)<0}function Ft(f,t,e,i,n,s){const l=e-f,r=i-t,o=n-f,c=s-t,d=l*l+r*r,a=o*o+c*c,h=.5/(l*c-r*o),u=(c*d-r*a)*h,m=(l*a-o*d)*h;return u*u+m*m}function Ut(f,t,e,i,n,s){const l=e-f,r=i-t,o=n-f,c=s-t,d=l*l+r*r,a=o*o+c*c,h=.5/(l*c-r*o),u=f+(c*d-r*a)*h,m=t+(l*a-o*d)*h;return{x:u,y:m}}function N(f,t,e,i){if(i-e<=20)for(let n=e+1;n<=i;n++){const s=f[n],l=t[s];let r=n-1;for(;r>=e&&t[f[r]]>l;)f[r+1]=f[r--];f[r+1]=s}else{const n=e+i>>1;let s=e+1,l=i;H(f,n,s),t[f[e]]>t[f[i]]&&H(f,e,i),t[f[s]]>t[f[i]]&&H(f,s,i),t[f[e]]>t[f[s]]&&H(f,e,s);const r=f[s],o=t[r];for(;;){do s++;while(t[f[s]]<o);do l--;while(t[f[l]]>o);if(l<s)break;H(f,s,l)}f[e+1]=f[l],f[l]=r,i-s+1>=l-e?(N(f,t,s,i),N(f,t,e,l-1)):(N(f,t,e,l-1),N(f,t,s,i))}}function H(f,t,e){const i=f[t];f[t]=f[e],f[e]=i}function Kt(f){return f[0]}function Nt(f){return f[1]}const ut=1e-6;class E{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,i){t=+t,e=+e,i=+i;const n=t+i,s=e;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${n},${s}`:(Math.abs(this._x1-n)>ut||Math.abs(this._y1-s)>ut)&&(this._+="L"+n+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${e}A${i},${i},0,1,1,${this._x1=n},${this._y1=s}`)}rect(t,e,i,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+i}v${+n}h${-i}Z`}value(){return this._||null}}class st{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class Bt{constructor(t,[e,i,n,s]=[0,0,960,500]){if(!((n=+n)>=(e=+e))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=n,this.xmin=e,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:i},vectors:n}=this;let s,l;const r=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let g=0,p=0,_=i.length,b,A;g<_;g+=3,p+=2){const k=i[g]*2,M=i[g+1]*2,I=i[g+2]*2,$=t[k],S=t[k+1],y=t[M],x=t[M+1],w=t[I],T=t[I+1],P=y-$,j=x-S,C=w-$,v=T-S,D=(P*v-j*C)*2;if(Math.abs(D)<1e-9){if(s===void 0){s=l=0;for(const L of e)s+=t[L*2],l+=t[L*2+1];s/=e.length,l/=e.length}const z=1e9*Math.sign((s-$)*v-(l-S)*C);b=($+w)/2-z*v,A=(S+T)/2+z*C}else{const z=1/D,L=P*P+j*j,F=C*C+v*v;b=$+(v*L-j*F)*z,A=S+(P*F-C*L)*z}r[p]=b,r[p+1]=A}let o=e[e.length-1],c,d=o*4,a,h=t[2*o],u,m=t[2*o+1];n.fill(0);for(let g=0;g<e.length;++g)o=e[g],c=d,a=h,u=m,d=o*4,h=t[2*o],m=t[2*o+1],n[c+2]=n[d]=u-m,n[c+3]=n[d+1]=h-a}render(t){const e=t==null?t=new E:void 0,{delaunay:{halfedges:i,inedges:n,hull:s},circumcenters:l,vectors:r}=this;if(s.length<=1)return null;for(let d=0,a=i.length;d<a;++d){const h=i[d];if(h<d)continue;const u=Math.floor(d/3)*2,m=Math.floor(h/3)*2,g=l[u],p=l[u+1],_=l[m],b=l[m+1];this._renderSegment(g,p,_,b,t)}let o,c=s[s.length-1];for(let d=0;d<s.length;++d){o=c,c=s[d];const a=Math.floor(n[c]/3)*2,h=l[a],u=l[a+1],m=o*4,g=this._project(h,u,r[m+2],r[m+3]);g&&this._renderSegment(h,u,g[0],g[1],t)}return e&&e.value()}renderBounds(t){const e=t==null?t=new E:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const i=e==null?e=new E:void 0,n=this._clip(t);if(n===null||!n.length)return;e.moveTo(n[0],n[1]);let s=n.length;for(;n[0]===n[s-2]&&n[1]===n[s-1]&&s>1;)s-=2;for(let l=2;l<s;l+=2)(n[l]!==n[l-2]||n[l+1]!==n[l-1])&&e.lineTo(n[l],n[l+1]);return e.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,i=t.length/2;e<i;++e){const n=this.cellPolygon(e);n&&(n.index=e,yield n)}}cellPolygon(t){const e=new st;return this.renderCell(t,e),e.value()}_renderSegment(t,e,i,n,s){let l;const r=this._regioncode(t,e),o=this._regioncode(i,n);r===0&&o===0?(s.moveTo(t,e),s.lineTo(i,n)):(l=this._clipSegment(t,e,i,n,r,o))&&(s.moveTo(l[0],l[1]),s.lineTo(l[2],l[3]))}contains(t,e,i){return e=+e,e!==e||(i=+i,i!==i)?!1:this.delaunay._step(t,e,i)===t}*neighbors(t){const e=this._clip(t);if(e)for(const i of this.delaunay.neighbors(t)){const n=this._clip(i);if(n){t:for(let s=0,l=e.length;s<l;s+=2)for(let r=0,o=n.length;r<o;r+=2)if(e[s]===n[r]&&e[s+1]===n[r+1]&&e[(s+2)%l]===n[(r+o-2)%o]&&e[(s+3)%l]===n[(r+o-1)%o]){yield i;break t}}}}_cell(t){const{circumcenters:e,delaunay:{inedges:i,halfedges:n,triangles:s}}=this,l=i[t];if(l===-1)return null;const r=[];let o=l;do{const c=Math.floor(o/3);if(r.push(e[c*2],e[c*2+1]),o=o%3===2?o-2:o+1,s[o]!==t)break;o=n[o]}while(o!==l&&o!==-1);return r}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(e===null)return null;const{vectors:i}=this,n=t*4;return this._simplify(i[n]||i[n+1]?this._clipInfinite(t,e,i[n],i[n+1],i[n+2],i[n+3]):this._clipFinite(t,e))}_clipFinite(t,e){const i=e.length;let n=null,s,l,r=e[i-2],o=e[i-1],c,d=this._regioncode(r,o),a,h=0;for(let u=0;u<i;u+=2)if(s=r,l=o,r=e[u],o=e[u+1],c=d,d=this._regioncode(r,o),c===0&&d===0)a=h,h=0,n?n.push(r,o):n=[r,o];else{let m,g,p,_,b;if(c===0){if((m=this._clipSegment(s,l,r,o,c,d))===null)continue;[g,p,_,b]=m}else{if((m=this._clipSegment(r,o,s,l,d,c))===null)continue;[_,b,g,p]=m,a=h,h=this._edgecode(g,p),a&&h&&this._edge(t,a,h,n,n.length),n?n.push(g,p):n=[g,p]}a=h,h=this._edgecode(_,b),a&&h&&this._edge(t,a,h,n,n.length),n?n.push(_,b):n=[_,b]}if(n)a=h,h=this._edgecode(n[0],n[1]),a&&h&&this._edge(t,a,h,n,n.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return n}_clipSegment(t,e,i,n,s,l){const r=s<l;for(r&&([t,e,i,n,s,l]=[i,n,t,e,l,s]);;){if(s===0&&l===0)return r?[i,n,t,e]:[t,e,i,n];if(s&l)return null;let o,c,d=s||l;d&8?(o=t+(i-t)*(this.ymax-e)/(n-e),c=this.ymax):d&4?(o=t+(i-t)*(this.ymin-e)/(n-e),c=this.ymin):d&2?(c=e+(n-e)*(this.xmax-t)/(i-t),o=this.xmax):(c=e+(n-e)*(this.xmin-t)/(i-t),o=this.xmin),s?(t=o,e=c,s=this._regioncode(t,e)):(i=o,n=c,l=this._regioncode(i,n))}}_clipInfinite(t,e,i,n,s,l){let r=Array.from(e),o;if((o=this._project(r[0],r[1],i,n))&&r.unshift(o[0],o[1]),(o=this._project(r[r.length-2],r[r.length-1],s,l))&&r.push(o[0],o[1]),r=this._clipFinite(t,r))for(let c=0,d=r.length,a,h=this._edgecode(r[d-2],r[d-1]);c<d;c+=2)a=h,h=this._edgecode(r[c],r[c+1]),a&&h&&(c=this._edge(t,a,h,r,c),d=r.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(r=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return r}_edge(t,e,i,n,s){for(;e!==i;){let l,r;switch(e){case 5:e=4;continue;case 4:e=6,l=this.xmax,r=this.ymin;break;case 6:e=2;continue;case 2:e=10,l=this.xmax,r=this.ymax;break;case 10:e=8;continue;case 8:e=9,l=this.xmin,r=this.ymax;break;case 9:e=1;continue;case 1:e=5,l=this.xmin,r=this.ymin;break}(n[s]!==l||n[s+1]!==r)&&this.contains(t,l,r)&&(n.splice(s,0,l,r),s+=2)}return s}_project(t,e,i,n){let s=1/0,l,r,o;if(n<0){if(e<=this.ymin)return null;(l=(this.ymin-e)/n)<s&&(o=this.ymin,r=t+(s=l)*i)}else if(n>0){if(e>=this.ymax)return null;(l=(this.ymax-e)/n)<s&&(o=this.ymax,r=t+(s=l)*i)}if(i>0){if(t>=this.xmax)return null;(l=(this.xmax-t)/i)<s&&(r=this.xmax,o=e+(s=l)*n)}else if(i<0){if(t<=this.xmin)return null;(l=(this.xmin-t)/i)<s&&(r=this.xmin,o=e+(s=l)*n)}return[r,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const i=(e+2)%t.length,n=(e+4)%t.length;(t[e]===t[i]&&t[i]===t[n]||t[e+1]===t[i+1]&&t[i+1]===t[n+1])&&(t.splice(i,2),e-=2)}t.length||(t=null)}return t}}const Ht=2*Math.PI,K=Math.pow;function Gt(f){return f[0]}function Ot(f){return f[1]}function Xt(f){const{triangles:t,coords:e}=f;for(let i=0;i<t.length;i+=3){const n=2*t[i],s=2*t[i+1],l=2*t[i+2];if((e[l]-e[n])*(e[s+1]-e[n+1])-(e[s]-e[n])*(e[l+1]-e[n+1])>1e-10)return!1}return!0}function Yt(f,t,e){return[f+Math.sin(f+t)*e,t+Math.cos(f-t)*e]}class lt{static from(t,e=Gt,i=Ot,n){return new lt("length"in t?Qt(t,e,i,n):Float64Array.from(Zt(t,e,i,n)))}constructor(t){this._delaunator=new tt(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&Xt(t)){this.collinear=Int32Array.from({length:e.length/2},(h,u)=>u).sort((h,u)=>e[2*h]-e[2*u]||e[2*h+1]-e[2*u+1]);const o=this.collinear[0],c=this.collinear[this.collinear.length-1],d=[e[2*o],e[2*o+1],e[2*c],e[2*c+1]],a=1e-8*Math.hypot(d[3]-d[1],d[2]-d[0]);for(let h=0,u=e.length/2;h<u;++h){const m=Yt(e[2*h],e[2*h+1],a);e[2*h]=m[0],e[2*h+1]=m[1]}this._delaunator=new tt(e)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,n=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,l=this.inedges.fill(-1),r=this._hullIndex.fill(-1);for(let o=0,c=i.length;o<c;++o){const d=s[o%3===2?o-2:o+1];(i[o]===-1||l[d]===-1)&&(l[d]=o)}for(let o=0,c=n.length;o<c;++o)r[n[o]]=o;n.length<=2&&n.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=n[0],l[n[0]]=1,n.length===2&&(l[n[1]]=0,this.triangles[1]=n[1],this.triangles[2]=n[1]))}voronoi(t){return new Bt(this,t)}*neighbors(t){const{inedges:e,hull:i,_hullIndex:n,halfedges:s,triangles:l,collinear:r}=this;if(r){const a=r.indexOf(t);a>0&&(yield r[a-1]),a<r.length-1&&(yield r[a+1]);return}const o=e[t];if(o===-1)return;let c=o,d=-1;do{if(yield d=l[c],c=c%3===2?c-2:c+1,l[c]!==t)return;if(c=s[c],c===-1){const a=i[(n[t]+1)%i.length];a!==d&&(yield a);return}}while(c!==o)}find(t,e,i=0){if(t=+t,t!==t||(e=+e,e!==e))return-1;const n=i;let s;for(;(s=this._step(i,t,e))>=0&&s!==i&&s!==n;)i=s;return s}_step(t,e,i){const{inedges:n,hull:s,_hullIndex:l,halfedges:r,triangles:o,points:c}=this;if(n[t]===-1||!c.length)return(t+1)%(c.length>>1);let d=t,a=K(e-c[t*2],2)+K(i-c[t*2+1],2);const h=n[t];let u=h;do{let m=o[u];const g=K(e-c[m*2],2)+K(i-c[m*2+1],2);if(g<a&&(a=g,d=m),u=u%3===2?u-2:u+1,o[u]!==t)break;if(u=r[u],u===-1){if(u=s[(l[t]+1)%s.length],u!==m&&K(e-c[u*2],2)+K(i-c[u*2+1],2)<a)return u;break}}while(u!==h);return d}render(t){const e=t==null?t=new E:void 0,{points:i,halfedges:n,triangles:s}=this;for(let l=0,r=n.length;l<r;++l){const o=n[l];if(o<l)continue;const c=s[l]*2,d=s[o]*2;t.moveTo(i[c],i[c+1]),t.lineTo(i[d],i[d+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){e===void 0&&(!t||typeof t.moveTo!="function")&&(e=t,t=null),e=e==null?2:+e;const i=t==null?t=new E:void 0,{points:n}=this;for(let s=0,l=n.length;s<l;s+=2){const r=n[s],o=n[s+1];t.moveTo(r+e,o),t.arc(r,o,e,0,Ht)}return i&&i.value()}renderHull(t){const e=t==null?t=new E:void 0,{hull:i,points:n}=this,s=i[0]*2,l=i.length;t.moveTo(n[s],n[s+1]);for(let r=1;r<l;++r){const o=2*i[r];t.lineTo(n[o],n[o+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new st;return this.renderHull(t),t.value()}renderTriangle(t,e){const i=e==null?e=new E:void 0,{points:n,triangles:s}=this,l=s[t*=3]*2,r=s[t+1]*2,o=s[t+2]*2;return e.moveTo(n[l],n[l+1]),e.lineTo(n[r],n[r+1]),e.lineTo(n[o],n[o+1]),e.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,i=t.length/3;e<i;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new st;return this.renderTriangle(t,e),e.value()}}function Qt(f,t,e,i){const n=f.length,s=new Float64Array(n*2);for(let l=0;l<n;++l){const r=f[l];s[l*2]=t.call(i,r,l,f),s[l*2+1]=e.call(i,r,l,f)}return s}function*Zt(f,t,e,i){let n=0;for(const s of f)yield t.call(i,s,n,f),yield e.call(i,s,n,f),++n}const rt=et.memo(({data:f,width:t=800,height:e=600,margin:i={top:20,right:20,bottom:20,left:20},colors:n=jt,showPoints:s=!0,pointRadius:l=3,showLabels:r=!0})=>{const o=et.useRef(null);return et.useEffect(()=>{if(!o.current||!f.length)return;const c=O(o.current);c.selectAll("*").remove();const d=Array.from(new Set(f.map(p=>p.group||p.id))),a=$t().domain(d).range(n),u=lt.from(f,p=>p.x,p=>p.y).voronoi([i.left,i.top,t-i.right,e-i.bottom]),m=c.append("g"),g=O("body").append("div").style("position","absolute").style("visibility","hidden").style("background-color","white").style("border","1px solid #ddd").style("padding","10px").style("border-radius","5px").style("font-size","12px");return m.selectAll("path").data(f).join("path").attr("d",(p,_)=>u.renderCell(_)).attr("fill",p=>a(p.group||p.id)).attr("fill-opacity",.3).attr("stroke","#000").attr("stroke-width",.5).on("mouseover",function(p,_){O(this).attr("fill-opacity",.5),g.style("visibility","visible").html(`
            ${_.label||_.id}<br/>
            ${_.group?`Group: ${_.group}`:""}
          `)}).on("mousemove",function(p){g.style("top",p.pageY-10+"px").style("left",p.pageX+10+"px")}).on("mouseout",function(){O(this).attr("fill-opacity",.3),g.style("visibility","hidden")}),s&&m.selectAll("circle").data(f).join("circle").attr("cx",p=>p.x).attr("cy",p=>p.y).attr("r",l).attr("fill",p=>a(p.group||p.id)).attr("stroke","#fff").attr("stroke-width",1),r&&m.selectAll("text").data(f).join("text").attr("x",p=>p.x).attr("y",p=>p.y-10).attr("text-anchor","middle").style("font-size","10px").style("fill","#333").text(p=>p.label||p.id),()=>{g.remove()}},[f,t,e,i,n,s,l,r]),Pt.jsx("svg",{ref:o,width:t,height:e})});rt.displayName="VoronoiDiagram";rt.__docgenInfo={description:"",methods:[],displayName:"VoronoiDiagram",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"VoronoiPoint"}],raw:"VoronoiPoint[]"},description:""},width:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"800",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"600",computed:!1}},margin:{required:!1,tsType:{name:"signature",type:"object",raw:"{ top: number; right: number; bottom: number; left: number }",signature:{properties:[{key:"top",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}},{key:"bottom",value:{name:"number",required:!0}},{key:"left",value:{name:"number",required:!0}}]}},description:"",defaultValue:{value:"{ top: 20, right: 20, bottom: 20, left: 20 }",computed:!1}},colors:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"d3.schemeSet3",computed:!0}},showPoints:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},pointRadius:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3",computed:!1}},showLabels:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};const le={title:"D3 Advanced/VoronoiDiagram",component:rt,parameters:{layout:"centered"},tags:["autodocs"]},Mt=(f,t,e)=>Array.from({length:f},(i,n)=>({id:`point-${n+1}`,x:Math.random()*(t-100)+50,y:Math.random()*(e-100)+50,label:`Point ${n+1}`,group:`Group ${Math.floor(n/5)+1}`})),B={args:{data:[{id:"1",x:100,y:100,label:"Point 1",group:"A"},{id:"2",x:200,y:100,label:"Point 2",group:"A"},{id:"3",x:150,y:200,label:"Point 3",group:"B"},{id:"4",x:300,y:150,label:"Point 4",group:"B"},{id:"5",x:400,y:200,label:"Point 5",group:"C"},{id:"6",x:350,y:300,label:"Point 6",group:"C"}]}},Q={args:{data:B.args.data,width:1e3,height:800,margin:{top:30,right:40,bottom:40,left:50},colors:["#1f77b4","#ff7f0e","#2ca02c"],pointRadius:5}},Z={args:{data:B.args.data,showPoints:!1,showLabels:!1}},J={args:{data:Mt(50,1e3,800),width:1e3,height:800,pointRadius:3,showLabels:!1}},W={args:{data:Mt(10,400,300),width:400,height:300,pointRadius:4}};var ft,dt,gt;B.parameters={...B.parameters,docs:{...(ft=B.parameters)==null?void 0:ft.docs,source:{originalSource:`{
  args: {
    data: [{
      id: "1",
      x: 100,
      y: 100,
      label: "Point 1",
      group: "A"
    }, {
      id: "2",
      x: 200,
      y: 100,
      label: "Point 2",
      group: "A"
    }, {
      id: "3",
      x: 150,
      y: 200,
      label: "Point 3",
      group: "B"
    }, {
      id: "4",
      x: 300,
      y: 150,
      label: "Point 4",
      group: "B"
    }, {
      id: "5",
      x: 400,
      y: 200,
      label: "Point 5",
      group: "C"
    }, {
      id: "6",
      x: 350,
      y: 300,
      label: "Point 6",
      group: "C"
    }]
  }
}`,...(gt=(dt=B.parameters)==null?void 0:dt.docs)==null?void 0:gt.source}}};var mt,pt,_t;Q.parameters={...Q.parameters,docs:{...(mt=Q.parameters)==null?void 0:mt.docs,source:{originalSource:`{
  args: {
    data: Default.args.data,
    width: 1000,
    height: 800,
    margin: {
      top: 30,
      right: 40,
      bottom: 40,
      left: 50
    },
    colors: ["#1f77b4", "#ff7f0e", "#2ca02c"],
    pointRadius: 5
  }
}`,...(_t=(pt=Q.parameters)==null?void 0:pt.docs)==null?void 0:_t.source}}};var yt,bt,wt;Z.parameters={...Z.parameters,docs:{...(yt=Z.parameters)==null?void 0:yt.docs,source:{originalSource:`{
  args: {
    data: Default.args.data,
    showPoints: false,
    showLabels: false
  }
}`,...(wt=(bt=Z.parameters)==null?void 0:bt.docs)==null?void 0:wt.source}}};var xt,vt,At;J.parameters={...J.parameters,docs:{...(xt=J.parameters)==null?void 0:xt.docs,source:{originalSource:`{
  args: {
    data: generateRandomPoints(50, 1000, 800),
    width: 1000,
    height: 800,
    pointRadius: 3,
    showLabels: false
  }
}`,...(At=(vt=J.parameters)==null?void 0:vt.docs)==null?void 0:At.source}}};var Tt,St,kt;W.parameters={...W.parameters,docs:{...(Tt=W.parameters)==null?void 0:Tt.docs,source:{originalSource:`{
  args: {
    data: generateRandomPoints(10, 400, 300),
    width: 400,
    height: 300,
    pointRadius: 4
  }
}`,...(kt=(St=W.parameters)==null?void 0:St.docs)==null?void 0:kt.source}}};const re=["Default","CustomStyle","NoPointsOrLabels","LargeDataset","SmallDataset"];export{Q as CustomStyle,B as Default,J as LargeDataset,Z as NoPointsOrLabels,W as SmallDataset,re as __namedExportsOrder,le as default};

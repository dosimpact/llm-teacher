import{n as R,a as $,d as U,b as X,c as Y,y as V}from"./nodrag-RD0ZtkeO.js";import{d as W,s as G}from"./transform-BIeV-TGt.js";import{p as H}from"./pointer-Drloq0xg.js";import{c as B,j as I}from"./manyBody-DMdDB1GA.js";const S=n=>()=>n;function C(n,{sourceEvent:c,subject:d,target:p,identifier:f,active:o,x:l,y:s,dx:b,dy:h,dispatch:w}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:c,enumerable:!0,configurable:!0},subject:{value:d,enumerable:!0,configurable:!0},target:{value:p,enumerable:!0,configurable:!0},identifier:{value:f,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:b,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:w}})}C.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function Z(n){return!n.ctrlKey&&!n.button}function k(){return this.parentNode}function _(n,c){return c??{x:n.x,y:n.y}}function ee(){return navigator.maxTouchPoints||"ontouchstart"in this}function ae(){var n=Z,c=k,d=_,p=ee,f={},o=W("start","drag","end"),l=0,s,b,h,w,z=0;function u(e){e.on("mousedown.drag",D).filter(p).on("touchstart.drag",t).on("touchmove.drag",v,R).on("touchend.drag touchcancel.drag",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function D(e,r){if(!(w||!n.call(this,e,r))){var a=y(this,c.call(this,e,r),e,r,"mouse");a&&(G(e.view).on("mousemove.drag",E,$).on("mouseup.drag",A,$),U(e.view),X(e),h=!1,s=e.clientX,b=e.clientY,a("start",e))}}function E(e){if(Y(e),!h){var r=e.clientX-s,a=e.clientY-b;h=r*r+a*a>z}f.mouse("drag",e)}function A(e){G(e.view).on("mousemove.drag mouseup.drag",null),V(e.view,h),Y(e),f.mouse("end",e)}function t(e,r){if(n.call(this,e,r)){var a=e.changedTouches,i=c.call(this,e,r),g=a.length,m,x;for(m=0;m<g;++m)(x=y(this,i,e,r,a[m].identifier,a[m]))&&(X(e),x("start",e,a[m]))}}function v(e){var r=e.changedTouches,a=r.length,i,g;for(i=0;i<a;++i)(g=f[r[i].identifier])&&(Y(e),g("drag",e,r[i]))}function T(e){var r=e.changedTouches,a=r.length,i,g;for(w&&clearTimeout(w),w=setTimeout(function(){w=null},500),i=0;i<a;++i)(g=f[r[i].identifier])&&(X(e),g("end",e,r[i]))}function y(e,r,a,i,g,m){var x=o.copy(),j=H(m||a,r),F,K,M;if((M=d.call(e,new C("beforestart",{sourceEvent:a,target:u,identifier:g,active:l,x:j[0],y:j[1],dx:0,dy:0,dispatch:x}),i))!=null)return F=M.x-j[0]||0,K=M.y-j[1]||0,function L(q,N,Q){var O=j,P;switch(q){case"start":f[g]=L,P=l++;break;case"end":delete f[g],--l;case"drag":j=H(Q||N,r),P=l;break}x.call(q,e,new C(q,{sourceEvent:N,subject:M,target:u,identifier:g,active:P,x:j[0]+F,y:j[1]+K,dx:j[0]-O[0],dy:j[1]-O[1],dispatch:x}),i)}}return u.filter=function(e){return arguments.length?(n=typeof e=="function"?e:S(!!e),u):n},u.container=function(e){return arguments.length?(c=typeof e=="function"?e:S(e),u):c},u.subject=function(e){return arguments.length?(d=typeof e=="function"?e:S(e),u):d},u.touchable=function(e){return arguments.length?(p=typeof e=="function"?e:S(!!e),u):p},u.on=function(){var e=o.on.apply(o,arguments);return e===o?u:e},u.clickDistance=function(e){return arguments.length?(z=(e=+e)*e,u):Math.sqrt(z)},u}function ie(n,c){var d,p=1;n==null&&(n=0),c==null&&(c=0);function f(){var o,l=d.length,s,b=0,h=0;for(o=0;o<l;++o)s=d[o],b+=s.x,h+=s.y;for(b=(b/l-n)*p,h=(h/l-c)*p,o=0;o<l;++o)s=d[o],s.x-=b,s.y-=h}return f.initialize=function(o){d=o},f.x=function(o){return arguments.length?(n=+o,f):n},f.y=function(o){return arguments.length?(c=+o,f):c},f.strength=function(o){return arguments.length?(p=+o,f):p},f}function te(n){return n.index}function J(n,c){var d=n.get(c);if(!d)throw new Error("node not found: "+c);return d}function ce(n){var c=te,d=z,p,f=B(30),o,l,s,b,h,w=1;n==null&&(n=[]);function z(t){return 1/Math.min(s[t.source.index],s[t.target.index])}function u(t){for(var v=0,T=n.length;v<w;++v)for(var y=0,e,r,a,i,g,m,x;y<T;++y)e=n[y],r=e.source,a=e.target,i=a.x+a.vx-r.x-r.vx||I(h),g=a.y+a.vy-r.y-r.vy||I(h),m=Math.sqrt(i*i+g*g),m=(m-o[y])/m*t*p[y],i*=m,g*=m,a.vx-=i*(x=b[y]),a.vy-=g*x,r.vx+=i*(x=1-x),r.vy+=g*x}function D(){if(l){var t,v=l.length,T=n.length,y=new Map(l.map((r,a)=>[c(r,a,l),r])),e;for(t=0,s=new Array(v);t<T;++t)e=n[t],e.index=t,typeof e.source!="object"&&(e.source=J(y,e.source)),typeof e.target!="object"&&(e.target=J(y,e.target)),s[e.source.index]=(s[e.source.index]||0)+1,s[e.target.index]=(s[e.target.index]||0)+1;for(t=0,b=new Array(T);t<T;++t)e=n[t],b[t]=s[e.source.index]/(s[e.source.index]+s[e.target.index]);p=new Array(T),E(),o=new Array(T),A()}}function E(){if(l)for(var t=0,v=n.length;t<v;++t)p[t]=+d(n[t],t,n)}function A(){if(l)for(var t=0,v=n.length;t<v;++t)o[t]=+f(n[t],t,n)}return u.initialize=function(t,v){l=t,h=v,D()},u.links=function(t){return arguments.length?(n=t,D(),u):n},u.id=function(t){return arguments.length?(c=t,u):c},u.iterations=function(t){return arguments.length?(w=+t,u):w},u.strength=function(t){return arguments.length?(d=typeof t=="function"?t:B(+t),E(),u):d},u.distance=function(t){return arguments.length?(f=typeof t=="function"?t:B(+t),A(),u):f},u}export{ie as c,ae as d,ce as l};
